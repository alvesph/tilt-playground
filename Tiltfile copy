# Instalação do toolkit usando script personalizado
local_resource(
    'toolkit-install',
    cmd='chmod +x ./toolkit/libs.sh && ./toolkit/libs.sh',
    labels=['toolkit']
)

local_resource(
    'create-cluster',
    cmd='k3d cluster create somename --config ./toolkit/cluster.yaml',
    labels=['cluster'],
    deps=['toolkit-install'],
    auto_init=False
)

local_resource(
    'use-context-dev',
    cmd='kubectl config use-context k3d-somename',
    deps=['create-cluster'],
    labels=['cluster']
)

local_resource(
    'install-sonarqube',
    'helm upgrade --install sonarqube-dev ./services/sonarqube --namespace sonarqube --create-namespace -f ./services/sonarqube/values.yaml',
    deps=['use-context-dev'],
    labels=['services']
)